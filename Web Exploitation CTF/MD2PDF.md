# MD2PDF

<img width="890" height="170" alt="image" src="https://github.com/user-attachments/assets/05d33e8e-d412-413b-8de2-9e6fcd3b2865" />

Let's look at the statement that the challenge has given us which could give us a hint.

```
Hello Hacker!

TopTierConversions LTD is proud to announce its latest and greatest product launch: MD2PDF.

This easy-to-use utility converts markdown files to PDF and is totally secure! Right...?
```

The statement hints at potential vulnerabilities related to inadequate input validation or improper file handling in the MD2PDF application. 

Users may exploit these weaknesses to manipulate markdown input or files, potentially leading to security breaches.

Doing nmap scan to find all the ports of this MACHINE_IP. `nmap -p- --min-rate 1000 -T4 MACHINE_IP`

<img width="319" height="107" alt="image" src="https://github.com/user-attachments/assets/bd8302db-a55c-41e3-87a9-faa60b8ff248" />

It consists of three ports: SSH, HTTP and UPnP

Useful port right now is HTTP so we will check that and UPnP is a Networking Protocol.

UPnP, or Universal Plug and Play, is a networking protocol that lets devices on a local network automatically discover each other and communicate without manual configuration, such as setting up port forwarding.

The website has a simple input space where we write all the sentences all the content and that is converted into the pdf.

<img width="781" height="269" alt="image" src="https://github.com/user-attachments/assets/f576c3df-f243-48e6-87ad-82ab037e6356" />

<img width="852" height="268" alt="image" src="https://github.com/user-attachments/assets/0f159509-060a-4047-9ce8-398530f82c8b" />

By checking the page source, it's nothing special as the script wires up a client-side Markdown editor and sends the Markdown text to the server to get back a generated PDF.

The phrase “wires up a client-side Markdown editor” simply means: It connects and activates a text editor in the user’s browser (on the client side) that lets you write and edit Markdown.

Also checked robots.txt so not found, we will use `gobuster` to find hidden directories.

`gobuster dir -u http://MACHINE_IP -w /usr/share/wordlists/dirb/common.txt`

<img width="376" height="164" alt="image" src="https://github.com/user-attachments/assets/dcd0e4c9-d464-4e7b-a8f9-8e718aa18248" />

There is admin directory in this website but it is forbidden to check and also can only be checked by the localhost so that means something is there that would be valuable.

<img width="261" height="109" alt="image" src="https://github.com/user-attachments/assets/a99b2b4a-ed6d-464e-bc38-28bd64965c22" />

This can be SSRF Vulnerability!

SSRF (Server-Side Request Forgery) — is when a website or service fetches a web address that a user gives it, and the attacker gives a sneaky address so the site talks to somewhere it shouldn’t (like the server’s own private network or a secret internal API).

Imagine you ask a friend to fetch a letter from a house for you. If they blindly go to any address you give, you could tell them to go into your friend’s locked garage and read private mail — because your friend will open whatever door you point them to.

So we can write a HTML code to show this website from the localhost so it will print the details that is in the admin directory which is forbidden for us to see directly.

Write `<iframe src="http://localhost:5000/admin"></iframe>` in the input and convert this to PDF.

<img width="673" height="257" alt="image" src="https://github.com/user-attachments/assets/f19f6e4a-af77-479d-8e74-74ac8f629a47" />

And then you see the flag in the PDF!

<img width="698" height="155" alt="Screenshot 2025-10-14 232545" src="https://github.com/user-attachments/assets/1423f5e8-2a4e-47b1-95c9-69c091d23ace" />
